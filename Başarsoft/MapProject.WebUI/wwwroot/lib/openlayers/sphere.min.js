import{toDegrees,toRadians}from"./math.js";const DEFAULT_RADIUS=6371008.8;function getDistance(t,e,a){a=a||DEFAULT_RADIUS;var n=toRadians(t[1]),r=toRadians(e[1]),o=(r-n)/2,e=toRadians(e[0]-t[0])/2,t=Math.sin(o)*Math.sin(o)+Math.sin(e)*Math.sin(e)*Math.cos(n)*Math.cos(r);return 2*a*Math.atan2(Math.sqrt(t),Math.sqrt(1-t))}function getLengthInternal(a,n){let r=0;for(let t=0,e=a.length;t<e-1;++t)r+=getDistance(a[t],a[t+1],n);return r}function getLength(t,e){var a=(e=e||{}).radius||DEFAULT_RADIUS,n=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(n,"EPSG:4326"));let o=0,s,i,g,h,l,c;switch(r){case"Point":case"MultiPoint":break;case"LineString":case"LinearRing":s=t.getCoordinates(),o=getLengthInternal(s,a);break;case"MultiLineString":case"Polygon":for(s=t.getCoordinates(),g=0,h=s.length;g<h;++g)o+=getLengthInternal(s[g],a);break;case"MultiPolygon":for(s=t.getCoordinates(),g=0,h=s.length;g<h;++g)for(i=s[g],l=0,c=i.length;l<c;++l)o+=getLengthInternal(i[l],a);break;case"GeometryCollection":var M=t.getGeometries();for(g=0,h=M.length;g<h;++g)o+=getLength(M[g],e);break;default:throw new Error("Unsupported geometry type: "+r)}return o}function getAreaInternal(e,t){let a=0;var n=e.length;let r=e[n-1][0],o=e[n-1][1];for(let t=0;t<n;t++){var s=e[t][0],i=e[t][1];a+=toRadians(s-r)*(2+Math.sin(toRadians(o))+Math.sin(toRadians(i))),r=s,o=i}return a*t*t/2}function getArea(t,e){var a=(e=e||{}).radius||DEFAULT_RADIUS,n=e.projection||"EPSG:3857",r=t.getType();"GeometryCollection"!==r&&(t=t.clone().transform(n,"EPSG:4326"));let o=0,s,i,g,h,l,c;switch(r){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":for(s=t.getCoordinates(),o=Math.abs(getAreaInternal(s[0],a)),g=1,h=s.length;g<h;++g)o-=Math.abs(getAreaInternal(s[g],a));break;case"MultiPolygon":for(s=t.getCoordinates(),g=0,h=s.length;g<h;++g)for(i=s[g],o+=Math.abs(getAreaInternal(i[0],a)),l=1,c=i.length;l<c;++l)o-=Math.abs(getAreaInternal(i[l],a));break;case"GeometryCollection":var M=t.getGeometries();for(g=0,h=M.length;g<h;++g)o+=getArea(M[g],e);break;default:throw new Error("Unsupported geometry type: "+r)}return o}function offset(t,e,a,n){n=n||DEFAULT_RADIUS;var r=toRadians(t[1]),t=toRadians(t[0]),e=e/n,n=Math.asin(Math.sin(r)*Math.cos(e)+Math.cos(r)*Math.sin(e)*Math.cos(a)),t=t+Math.atan2(Math.sin(a)*Math.sin(e)*Math.cos(r),Math.cos(e)-Math.sin(r)*Math.sin(n));return[toDegrees(t),toDegrees(n)]}export{DEFAULT_RADIUS,getDistance,getLength,getArea,offset};