import{binarySearch}from"../../array.js";import{lerp}from"../../math.js";function interpolatePoint(i,l,o,u,r,t,e){let f,a;var s=(o-l)/u;if(1==s)f=l;else if(2==s)f=l,a=r;else if(0!=s){let t=i[l],e=i[l+1],n=0;const p=[0];for(let r=l+u;r<o;r+=u){var c=i[r],h=i[r+1];n+=Math.sqrt((c-t)*(c-t)+(h-e)*(h-e)),p.push(n),t=c,e=h}s=r*n,r=binarySearch(p,s);f=r<0?(a=(s-p[-r-2])/(p[-r-1]-p[-r-2]),l+(-r-2)*u):l+r*u}e=1<e?e:2,t=t||new Array(e);for(let r=0;r<e;++r)t[r]=void 0===f?NaN:void 0===a?i[f+r]:lerp(i[f+r],i[f+u+r],a);return t}function lineStringCoordinateAtM(t,r,e,n,i,l){if(e==r)return null;let o;if(i<t[r+n-1])return l?((o=t.slice(r,r+n))[n-1]=i,o):null;if(t[e-1]<i)return l?((o=t.slice(e-n,e))[n-1]=i,o):null;if(i==t[r+n-1])return t.slice(r,r+n);let u=r/n,f=e/n;for(;u<f;){var a=u+f>>1;i<t[(1+a)*n-1]?f=a:u=1+a}l=t[u*n-1];if(i==l)return t.slice((u-1)*n,(u-1)*n+n);var s=(i-l)/(t[(u+1)*n-1]-l);o=[];for(let r=0;r<n-1;++r)o.push(lerp(t[(u-1)*n+r],t[u*n+r],s));return o.push(i),o}function lineStringsCoordinateAtM(e,n,i,l,o,r,t){if(t)return lineStringCoordinateAtM(e,n,i[i.length-1],l,o,r);let u;if(o<e[l-1])return r?((u=e.slice(0,l))[l-1]=o,u):null;if(e[e.length-1]<o)return r?((u=e.slice(e.length-l))[l-1]=o,u):null;for(let r=0,t=i.length;r<t;++r){var f=i[r];if(n!=f){if(o<e[n+l-1])return null;if(o<=e[f-1])return lineStringCoordinateAtM(e,n,f,l,o,!1);n=f}}return null}export{interpolatePoint,lineStringCoordinateAtM,lineStringsCoordinateAtM};