import{getSharedCanvasContext2D}from"../../dom.js";class ZIndexContext{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(getSharedCanvasContext2D(),{get:(t,s)=>{if("function"==typeof getSharedCanvasContext2D()[s])return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(s),this.pushMethodArgs_},set:(t,s,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(s,i),!0)})}pushMethodArgs_=(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this);pushFunction(t){this.instructions_[this.zIndex+this.offset_].push(t)}getContext(){return this.context_}draw(h){this.instructions_.forEach(i=>{for(let t=0,s=i.length;t<s;++t){const n=i[t];if("function"==typeof n)n(h);else{const e=i[++t];"function"==typeof h[n]?h[n](...e):"function"==typeof e?h[n]=e(h):h[n]=e}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}export default ZIndexContext;