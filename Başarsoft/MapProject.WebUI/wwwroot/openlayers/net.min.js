import{getUid}from"./util.js";function jsonp(e,t,r,n){const s=document.createElement("script"),o="olc_"+getUid(t);function i(){delete window[o],s.parentNode.removeChild(s)}s.async=!0,s.src=e+(e.includes("?")?"&":"?")+(n||"callback")+"="+o;const c=setTimeout(function(){i(),r&&r()},1e4);window[o]=function(e){clearTimeout(c),i(),t(e)},document.head.appendChild(s)}class ResponseError extends Error{constructor(e){super("Unexpected response status: "+e.status),this.name="ResponseError",this.response=e}}class ClientError extends Error{constructor(e){super("Failed to issue request"),this.name="ClientError",this.client=e}}function getJSON(t){return new Promise(function(n,s){const e=new XMLHttpRequest;e.addEventListener("load",function(t){if(!(t=t.target).status||200<=t.status&&t.status<300){let e;try{e=JSON.parse(t.responseText)}catch(e){var r="Error parsing response text as JSON: "+e.message;return void s(new Error(r))}void n(e)}else s(new ResponseError(t))}),e.addEventListener("error",function(e){s(new ClientError(e.target))}),e.open("GET",t),e.setRequestHeader("Accept","application/json"),e.send()})}function resolveUrl(e,t){return t.includes("://")?t:new URL(t,e).href}let originalXHR;function overrideXHR(e){"undefined"!=typeof XMLHttpRequest&&(originalXHR=XMLHttpRequest),global.XMLHttpRequest=e}function restoreXHR(){global.XMLHttpRequest=originalXHR}export{jsonp,ResponseError,ClientError,getJSON,resolveUrl,overrideXHR,restoreXHR};